<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Avaliar Peste</title>
  <link href="../loginmotorista/lotacao.css" rel="stylesheet" type="text/css" />
  <link rel="shortcut icon" href="../imagens/favicon.ico" type="image/x-icon">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="sweetalert2.all.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
  <link rel="stylesheet"
  href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
</head>

<body>
  <header>
  <div class="primeira">
    <nav>
     <div>
       <img class="logo" src="../imagens/logosemfundo.png" alt="TransPeste">
     </div>
     <ul>
        <li onclick="redirecionarhome()"> <a href="#">Home</a></li>
        <li> <a href="#">Info</a></li>
        <li> <a href="#">Sobre</a></li>
        <li><button type="button"> <a href="#"onclick= "redirecionarperfil()">Meu Perfil</a> </button></li>
      </ul>
    </nav>
  </div>
</header>
      <div class="meioD">
        <div class="centro">
        <section class="rating">
        <div class="foto">
            <img src="../imagens/fernando.png" alt="">
            <p id="nomeC"></p>
        </div>
        
          <div class="estrela">
            <input type="radio" id="star5" name="rating" value="5">
            <label for="star5"></label>
            <input type="radio" id="star4" name="rating" value="4">
            <label for="star4"></label>
            <input type="radio" id="star3" name="rating" value="3">
            <label for="star3"></label>
            <input type="radio" id="star2" name="rating" value="2">
            <label for="star2"></label>
            <input type="radio" id="star1" name="rating" value="1">
            <label for="star1"></label>
          </div>
          <div class="comentario">
            <textarea id="comment" name="comment" placeholder="Digite seu comentário..."></textarea>
          </div>
          <div class="botao">
            <button type="submit"> <a href="#"onclick= "enviar()">Enviar</a> </button>
          </div>
        </section>
      </div>
      </div>
<footer>
      <section class="Contato">
        <div class="infogeral">
            <div class="pri">

                <p>Rua dos bobos n 0,Brazil, <br> Sp Grande São Paulo 32241 290</p>
                <p>4002 8922</p>
                <p>TransPeste@gmail.com</p>

   
            </div>

            <div class="seg">
                <h4>Suporte</h4>
                <p>Sobre nos</p>
                <p>Guia de Cadastro</p>
                <p>Termos</p>
                <p>FAQ</p>
                <p>Privacidade</p>
            </div>

            <div class="ter">
                <h4>Nossas Redes Sociais</h4>
             <div class="media">
                    <a href="#"><i class='bx bxl-facebook'></i></a>
                    <a href="#"><i class='bx bxl-twitter' ></i></a>
                    <a href="#"><i class='bx bxl-instagram' ></i></a>
                    <a href="#"><i class='bx bxl-youtube' ></i></a>
                    <a href="#"><i class='bx bxl-linkedin' ></i></a>
                </div>
            </div>

            <div class="qua">
                <h4>TransPeste</h4>
                <p>Tudo sobre viagens</p>
                <p>Segurança na hora de viajar</p>
                <p>Certificados</p>
                <p>Login</p>
            </div>

  
        </div>
    </section>
  </footer>

    <div class="rodape">
        <p>Copyright © @2023. All Rights Reserved.Designd By TransPeste.</p>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js%22%3E"></script>
    <script src="httpvscode-file://vscode-app/c:/programa%C3%A7%C3%A3o/Microsoft%20VS%20Code/resources/app/out/vs/code/electron-sandbox/workbench/workbench.htmls://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js%22%3E"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
    const urlcrianca = 'https://crud-server-json-trans-peste.vercel.app/criancas'
    var frase = document.getElementById('nomeC')
    const dadosurl = new URLSearchParams(window.location.search)
    const idurl = dadosurl.get('id');
    const idcrianca = new URLSearchParams(window.location.search).get('idcrianca');
    var ratingValue = 0;
      if(!idurl){
    window.location.href="../telainicial/login.html"
}
      async function nome(){
              const dadoscrianca = await fetch(urlcrianca+'/'+idcrianca)
              console.log(urlcrianca+'/'+idcrianca)
              const criancajson = await dadoscrianca.json()
              frase.innerHTML = criancajson.nome
            }
      nome()
      function updateRating(event) {
        ratingValue = parseInt(event.target.value);
        console.log("Valor estrela selecionada: " + ratingValue);
      }
      var stars = document.querySelectorAll('.estrela input[type="radio"]');
      stars.forEach(function(star) {
      star.addEventListener('click', updateRating);
      });
      function getRating() {
        return axios.get('https://crud-server-json-trans-peste.vercel.app/criancas/'+idcrianca)
          .then(function(response) {
            return response.data.avalicao;
           })
          .catch(function(error) {
            console.error(error);
            throw error; 
          });
        }
      var oldrating=getRating();
      var newrating=(oldrating+ratingValue)/2;
      var url = 'https://crud-server-json-trans-peste.vercel.app/criancas/'+idcrianca;
      console.log(url)
      console.log(ratingValue)
      /*axios.put(url, {
        avalicao: ratingValue
      })*/
      function enviar(){
        $(document).ready(function(){

        Swal.fire({
          icon: 'success',
          title: 'Avaliação enviada com sucesso!',
          showConfirmButton: true,
          confirmButtonText: 'OK',
          timer: 1500
        }).then((result) => {
          if (result.isConfirmed) {
            window.location.href=`../loginusuario/selecionarassento.html?id=${idurl}`;
          }
        })
        })
          
      }

      function redirecionarhome()
{
        window.location.href= `../loginmotorista/cadastrarrota.html?id=${idurl} `
}

function redirecionarperfil()
{
        window.location.href= `../loginusuario/perfil_motorista.html?id=${idurl} `
}
    </script>



  
</body>

</html>